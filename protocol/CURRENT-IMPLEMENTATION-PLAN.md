# STAGETEK CRM - Implementation Plan
**Strategic Roadmap for React + TypeScript + Supabase CRM**

**Version**: 1.0.0
**Date**: 3 de Outubro de 2025
**Status**: Active Development
**Owner**: STAGETEK Engineering Team

---

## üìã Executive Summary

### Current State

**Overall Progress**: ~15% MVP Implementado

**Completed**:
- ‚úÖ Project setup (React 18 + Vite + TypeScript)
- ‚úÖ Tailwind CSS configured with STAGETEK design tokens
- ‚úÖ Supabase integration (client setup)
- ‚úÖ Basic authentication structure (`useAuth` hook)
- ‚úÖ Atomic Design structure (atoms/ molecules/ organisms/ templates/)
- ‚úÖ Core components: Button, Badge, Input, Select, Spinner, Checkbox
- ‚úÖ Layout components: MainLayout, TopBar, ProtectedRoute
- ‚úÖ Pages: Login, Dashboard (basic), Clientes (basic), Oportunidades (basic)

**In Progress**:
- üîÑ CRUD Clientes (modal exists, needs Supabase integration)
- üîÑ CRUD Oportunidades (modal exists, needs Supabase integration)
- üîÑ Dashboard (components exist, needs real data)

**Not Started**:
- ‚ùå Funil de Vendas Kanban
- ‚ùå Detalhes da Oportunidade (page doesn't exist)
- ‚ùå Sistema de Tarefas
- ‚ùå Sistema de Cota√ß√µes
- ‚ùå CRUD Produtos
- ‚ùå Relat√≥rios Gerenciais
- ‚ùå Integra√ß√µes (Email, Slack, Calendar)

### Timeline to Functional MVP

**Estimate**: 8-10 semanas (40-50 dias √∫teis)

**Critical Path**:
1. **Weeks 1-2**: Complete P0 CRUD operations (Clientes + Oportunidades)
2. **Weeks 3-4**: Funil de Vendas Kanban + Detalhes Oportunidade
3. **Weeks 5-6**: Sistema de Tarefas + Dashboard with real data
4. **Weeks 7-8**: CRUD Produtos + Sistema de Cota√ß√µes (basic)
5. **Weeks 9-10**: Testing + Bug fixes + Documentation

### Main Risks

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| **Supabase Row Level Security (RLS)** not properly configured | üü° Medium | üî¥ High | Create RLS policies early, test with multiple users |
| **Drag-and-drop mobile** (dnd-kit) UX issues | üü° Medium | üü° Medium | Test on real devices, fallback to buttons |
| **Timeline overrun** due to scope creep | üî¥ High | üü° Medium | Strict adherence to P0/P1 prioritization |
| **Protocol Notecraft‚Ñ¢** line limits block complex components | üü¢ Low | üü¢ Low | Use composition, extract hooks |

---

## üéØ Implementation Phases

### **Phase 1: P0 - CRITICAL MVP (Weeks 1-6)**

Without this, the CRM doesn't function.

---

## Feature: P0.1 - Authentication & Authorization

**Priority**: P0 (CRITICAL)
**Estimate**: 3-5 days
**Dependencies**: Supabase Auth configured
**Status**: üîÑ In Progress (50% - structure exists, needs integration)

### Files to create/modify:

- [x] `src/hooks/useAuth.ts` - CREATED (needs completion)
- [ ] `src/pages/Login.tsx` - EXISTS (needs Supabase integration)
- [ ] `src/components/layouts/ProtectedRoute.tsx` - EXISTS (needs auth check)
- [ ] `src/pages/RecuperarSenha.tsx` - TODO
- [ ] `supabase/migrations/001_enable_rls.sql` - TODO

### Checklist de Aceita√ß√£o:

- [ ] Login com email/senha funciona (Supabase Auth)
- [ ] Recupera√ß√£o de senha via email (Resend API)
- [ ] Logout funcional (clear session)
- [ ] Prote√ß√£o de rotas (redirect n√£o autenticado ‚Üí /login)
- [ ] Row Level Security (RLS) habilitado em todas as tabelas
- [ ] Session persistence (localStorage + refresh token)
- [ ] Error handling (credenciais inv√°lidas, rede offline)
- [ ] Loading states durante autentica√ß√£o
- [ ] Mobile-responsive login form

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P0.1 - Autentica√ß√£o e Controle de Acesso" (linha 148)
- **GAP-ANALYSIS.md**: N√£o mencionado (j√° existente)
- **FEATURES-PRIORITIZED.md**: Feature #1 (linha 10)

### Implementation Steps:

1. **Supabase Setup** (1 dia):
   - [ ] Configure Supabase Auth providers (email/password)
   - [ ] Create users table in Supabase
   - [ ] Setup email templates (confirmation, reset)
   - [ ] Configure Resend API for emails

2. **Authentication Hook** (1 dia):
   - [ ] Complete `useAuth.ts` with Supabase methods
   - [ ] Add `signIn(email, password)` method
   - [ ] Add `signOut()` method
   - [ ] Add `resetPassword(email)` method
   - [ ] Add `getCurrentUser()` method
   - [ ] Add session state management

3. **Login Page** (1 dia):
   - [ ] Integrate Login.tsx with `useAuth`
   - [ ] Add form validation (React Hook Form + Zod)
   - [ ] Add loading states
   - [ ] Add error messages
   - [ ] Mobile-optimized layout

4. **Protected Routes** (1 dia):
   - [ ] Update ProtectedRoute.tsx to check auth
   - [ ] Implement redirect logic
   - [ ] Add loading spinner while checking auth

5. **Row Level Security** (1 dia):
   - [ ] Create RLS policies for `clients` table
   - [ ] Create RLS policies for `opportunities` table
   - [ ] Create RLS policies for `products` table
   - [ ] Test policies with different users

---

## Feature: P0.2 - CRUD Clientes B2B

**Priority**: P0 (CRITICAL)
**Estimate**: 5-7 days
**Dependencies**: P0.1 Authentication
**Status**: üîÑ In Progress (40% - UI exists, needs backend)

### Files to create/modify:

- [x] `src/pages/Clientes.tsx` - EXISTS (needs data integration)
- [x] `src/components/organisms/ClientTable.tsx` - EXISTS
- [x] `src/components/organisms/ClienteModal.tsx` - EXISTS (needs form submission)
- [x] `src/components/molecules/ClientCard.tsx` - EXISTS
- [ ] `src/hooks/useClientes.ts` - TODO (Supabase queries)
- [ ] `supabase/migrations/002_create_clients.sql` - TODO
- [ ] `src/types/database.ts` - TODO (Client type)

### Checklist de Aceita√ß√£o:

- [ ] Formul√°rio de cadastro com valida√ß√£o (React Hook Form + Zod)
- [ ] Autocomplete CNPJ (brasil-api-mcp integration)
- [ ] Campos obrigat√≥rios: nome, CNPJ, email, telefone, endere√ßo
- [ ] Campo status: ativo, inativo, pendente (dropdown)
- [ ] Listagem de clientes (DataTable com pagina√ß√£o)
- [ ] Busca por nome/CNPJ (real-time)
- [ ] Filtros: status, data cria√ß√£o
- [ ] Editar cliente (modal pre-filled)
- [ ] Desativar cliente (soft delete - status = 'inactive')
- [ ] Avatar com iniciais do nome
- [ ] Badge de status (cores diferentes)
- [ ] Mobile: cards ao inv√©s de tabela
- [ ] Exportar lista para Excel (opcional P1)

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P0.2 - CRUD Clientes B2B" (linha 162)
- **GAP-ANALYSIS.md**: N√£o mencionado (j√° existente parcialmente)
- **RD-STATION-ANALYSIS.md**: Tela "Empresas/Clientes" (linha 812)
- **FEATURES-PRIORITIZED.md**: Feature #2 (linha 17)

### Implementation Steps:

1. **Database Schema** (1 dia):
   - [ ] Create `clients` table migration
   - [ ] Add columns: id, name, cnpj, email, phone, address (JSONB), status, created_at, updated_at, created_by
   - [ ] Add unique constraint on CNPJ
   - [ ] Add RLS policies
   - [ ] Add indexes on name, cnpj, status

2. **Supabase Hook** (2 dias):
   - [ ] Create `useClientes.ts` hook
   - [ ] `getClientes()` - fetch all clients with filters
   - [ ] `getClienteById(id)` - fetch single client
   - [ ] `createCliente(data)` - insert new client
   - [ ] `updateCliente(id, data)` - update client
   - [ ] `deleteCliente(id)` - soft delete (status = inactive)
   - [ ] Add loading/error states
   - [ ] Add optimistic updates (React Query or manual)

3. **CNPJ Autocomplete** (1 dia):
   - [ ] Create `useCNPJ.ts` hook
   - [ ] Integrate brasil-api-mcp
   - [ ] Fetch company data by CNPJ
   - [ ] Auto-fill: name, address from API
   - [ ] Add validation (14 digits, valid format)
   - [ ] Add loading state while fetching

4. **Form Integration** (2 dias):
   - [ ] Update ClienteModal.tsx with React Hook Form
   - [ ] Add Zod schema validation
   - [ ] Connect form to `useClientes` hook
   - [ ] Handle create/update logic
   - [ ] Add success/error notifications
   - [ ] Reset form after success

5. **List & Filters** (1 dia):
   - [ ] Connect ClientTable to `useClientes`
   - [ ] Add pagination (10/20/50 per page)
   - [ ] Add search input (debounced)
   - [ ] Add status filter dropdown
   - [ ] Add date range filter
   - [ ] Mobile: render ClientCard components

---

## Feature: P0.3 - CRUD Oportunidades

**Priority**: P0 (CRITICAL)
**Estimate**: 5-7 days
**Dependencies**: P0.2 CRUD Clientes
**Status**: üîÑ In Progress (35% - UI exists, needs backend)

### Files to create/modify:

- [x] `src/pages/Oportunidades.tsx` - EXISTS (needs data integration)
- [x] `src/components/organisms/OpportunitiesTable.tsx` - EXISTS
- [x] `src/components/organisms/OportunidadeModal.tsx` - EXISTS
- [ ] `src/hooks/useOportunidades.ts` - TODO
- [ ] `supabase/migrations/003_create_opportunities.sql` - TODO
- [ ] `src/types/database.ts` - TODO (Opportunity type)

### Checklist de Aceita√ß√£o:

- [ ] Formul√°rio de criar oportunidade
- [ ] Campos: t√≠tulo, cliente (dropdown), valor (BRL/USD/EUR), est√°gio, data esperada fechamento, descri√ß√£o
- [ ] Multi-currency support (BRL, USD, EUR)
- [ ] Convers√£o de moeda (USD/EUR ‚Üí BRL) - taxa hardcoded ou API
- [ ] Listagem de oportunidades com filtros
- [ ] Filtros: est√°gio, cliente, data cria√ß√£o, valor m√≠nimo/m√°ximo
- [ ] Editar oportunidade (modal pre-filled)
- [ ] Excluir oportunidade (confirm dialog)
- [ ] Hist√≥rico de mudan√ßas de est√°gio (ActivityLog table)
- [ ] Qualifica√ß√£o (1-5 estrelas) - visual
- [ ] Respons√°vel (dropdown de usu√°rios)
- [ ] Mobile: cards com informa√ß√µes principais

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P0.3 - CRUD Oportunidades" (linha 180)
- **GAP-ANALYSIS.md**: Mencionado em m√∫ltiplas se√ß√µes
- **RD-STATION-ANALYSIS.md**: Detalhes da Oportunidade (linha 222)
- **FEATURES-PRIORITIZED.md**: Feature #3 (linha 24)

### Implementation Steps:

1. **Database Schema** (1 dia):
   - [ ] Create `opportunities` table
   - [ ] Columns: id, title, client_id (FK), value, currency, stage, expected_close_date, probability, description, assigned_to, qualification, created_at, updated_at
   - [ ] Create `activity_log` table (for stage changes)
   - [ ] Add RLS policies
   - [ ] Add indexes on stage, client_id, assigned_to

2. **Supabase Hook** (2 dias):
   - [ ] Create `useOportunidades.ts`
   - [ ] `getOportunidades()` - with joins to clients table
   - [ ] `getOportunidadeById(id)` - with full details
   - [ ] `createOportunidade(data)` - insert
   - [ ] `updateOportunidade(id, data)` - update
   - [ ] `deleteOportunidade(id)` - hard delete
   - [ ] `updateStage(id, newStage)` - with activity log
   - [ ] Add loading/error states

3. **Currency Conversion** (1 dia):
   - [ ] Create `useCurrency.ts` hook
   - [ ] Fetch exchange rates (API or hardcoded)
   - [ ] Convert USD/EUR ‚Üí BRL
   - [ ] Display converted values in UI
   - [ ] Add currency selector in form

4. **Form Integration** (2 dias):
   - [ ] Update OportunidadeModal with React Hook Form
   - [ ] Add Zod validation
   - [ ] Connect to `useOportunidades`
   - [ ] Add cliente dropdown (from `useClientes`)
   - [ ] Add respons√°vel dropdown (from users)
   - [ ] Add qualifica√ß√£o (star rating component)
   - [ ] Handle create/update

5. **List & Filters** (1 dia):
   - [ ] Connect OpportunitiesTable to hook
   - [ ] Add filters (stage, client, date, value range)
   - [ ] Add sorting (value, date, stage)
   - [ ] Mobile: render opportunity cards

---

## Feature: P0.4 - Funil de Vendas (Kanban)

**Priority**: P0 (CRITICAL)
**Estimate**: 7-10 days
**Dependencies**: P0.3 CRUD Oportunidades
**Status**: ‚ùå Not Started (0%)

### Files to create/modify:

- [ ] `src/pages/FunilVendas.tsx` - TODO
- [ ] `src/components/organisms/KanbanBoard.tsx` - TODO
- [ ] `src/components/molecules/KanbanColumn.tsx` - TODO
- [ ] `src/components/molecules/OpportunityCard.tsx` - TODO
- [ ] `src/components/atoms/QualificationStars.tsx` - TODO
- [ ] `src/components/atoms/ActionIcon.tsx` - TODO
- [ ] `src/hooks/useFunil.ts` - TODO
- [ ] `supabase/migrations/004_create_funnels.sql` - TODO

### Checklist de Aceita√ß√£o:

- [ ] Layout Kanban com 5 colunas (default funnel)
- [ ] Colunas: Lead, Contato Inicial, Proposta Enviada, Negocia√ß√£o, Fechamento
- [ ] Drag-and-drop entre est√°gios (dnd-kit library)
- [ ] Atualiza√ß√£o autom√°tica do est√°gio no banco (Supabase realtime opcional)
- [ ] Totalizador de valor por coluna (soma de oportunidades.value)
- [ ] Contador de oportunidades por coluna
- [ ] Cards com: t√≠tulo, cliente, valor, qualifica√ß√£o (estrelas), √≠cones de a√ß√£o
- [ ] √çcones de a√ß√£o: telefone, email, info (quick actions)
- [ ] Mobile: swipe para mover (ou bot√µes "Mover para...")
- [ ] Filtros: por vendedor, per√≠odo, valor m√≠nimo, status
- [ ] Dropdown de sele√ß√£o de funil (se m√∫ltiplos funis existirem)
- [ ] Tooltip ao hover (ver detalhes r√°pidos)
- [ ] Indicador de tarefas atrasadas (√≠cone vermelho)
- [ ] Avatar do cliente nos cards (inicial do nome)

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P0.4 - Funil de Vendas (Kanban)" (linha 196)
- **GAP-ANALYSIS.md**: Se√ß√£o "1. Funil de Vendas Kanban (70% completo)" (linha 23)
- **RD-STATION-ANALYSIS.md**: Tela 1: Funil de Vendas (linha 36)
- **FEATURES-PRIORITIZED.md**: Feature #4 (linha 31)

### Implementation Steps:

1. **Database Schema - Funnels** (1 dia):
   - [ ] Create `funnels` table (id, name, stages array)
   - [ ] Create `funnel_stages` table (id, funnel_id, name, abbreviation, order, color)
   - [ ] Seed default funnel: "Funil PADR√ÉO"
   - [ ] Add RLS policies

2. **Kanban Components** (3 dias):
   - [ ] Create `OpportunityCard` molecule (‚â§35 lines)
     - [ ] Title, client name, values
     - [ ] QualificationStars component
     - [ ] Action icons (phone, email, info)
     - [ ] Client avatar (initials)
     - [ ] Late task indicator (red icon)
   - [ ] Create `KanbanColumn` molecule (‚â§35 lines)
     - [ ] Header: stage name, count, total value
     - [ ] Scrollable card list
     - [ ] Drop zone for drag-and-drop
   - [ ] Create `KanbanBoard` organism (‚â§50 lines)
     - [ ] 5 columns layout (horizontal scroll mobile)
     - [ ] dnd-kit DndContext wrapper
     - [ ] Handle drop events

3. **Drag-and-Drop Logic** (2 dias):
   - [ ] Install `@dnd-kit/core` and `@dnd-kit/sortable`
   - [ ] Implement drag sensors (mouse + touch)
   - [ ] Handle onDragEnd event
   - [ ] Update opportunity stage in Supabase
   - [ ] Optimistic update (move card immediately, rollback on error)
   - [ ] Mobile: alternative button interface ("Mover para...")

4. **Filters & Actions** (2 dias):
   - [ ] Add filter bar (funil, vendedor, per√≠odo, valor m√≠nimo)
   - [ ] Add dropdown to switch funnels
   - [ ] Add "Recarregar" button
   - [ ] Add "Filtro ativo" badge (count of active filters)
   - [ ] Quick actions: phone ‚Üí open dialer, email ‚Üí compose, info ‚Üí details page

5. **Totals & Counters** (1 dia):
   - [ ] Calculate column totals (sum of values in BRL)
   - [ ] Display count of opportunities
   - [ ] Update on card move
   - [ ] Handle multi-currency (convert to BRL for totals)

6. **Mobile Optimizations** (1 dia):
   - [ ] Horizontal scroll columns
   - [ ] Touch-friendly drag (larger touch areas)
   - [ ] Bottom sheet for filters (mobile)
   - [ ] Swipe gestures (optional)

---

## Feature: P0.5 - Dashboard B√°sico

**Priority**: P0 (CRITICAL)
**Estimate**: 4-6 days
**Dependencies**: P0.3 CRUD Oportunidades (data exists)
**Status**: üîÑ In Progress (60% - components exist, needs real data)

### Files to create/modify:

- [x] `src/pages/Dashboard.tsx` - EXISTS (needs data integration)
- [x] `src/components/organisms/StatsGrid.tsx` - EXISTS
- [x] `src/components/molecules/StatCard.tsx` - EXISTS
- [ ] `src/hooks/useDashboard.ts` - TODO (aggregate queries)
- [ ] `src/components/organisms/RevenueChart.tsx` - TODO
- [ ] `src/components/organisms/PipelineChart.tsx` - TODO

### Checklist de Aceita√ß√£o:

- [ ] 4 Stat Cards: Total Vendas (m√™s), Oportunidades Abertas, Taxa Convers√£o, Ticket M√©dio
- [ ] Stat Cards com √≠cones, valores, trend (‚Üë ou ‚Üì)
- [ ] Gr√°fico 1: Vendas ao Longo do Tempo (Recharts linha)
- [ ] Gr√°fico 2: Oportunidades por Est√°gio (Recharts pizza ou barras)
- [ ] Tabela: √öltimas 5 oportunidades (com link para detalhes)
- [ ] Filtro de per√≠odo: 7 dias, 30 dias, 90 dias, ano
- [ ] Dark mode toggle funcional
- [ ] Mobile: cards empilhados, gr√°ficos responsivos
- [ ] Loading states enquanto carrega dados
- [ ] Empty states se n√£o houver dados

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P0.5 - Dashboard B√°sico" (linha 212)
- **GAP-ANALYSIS.md**: Se√ß√£o "5. Dashboard (70% implementado)" (linha 190)
- **FEATURES-PRIORITIZED.md**: Feature #5 (linha 38)

### Implementation Steps:

1. **Dashboard Hook** (2 dias):
   - [ ] Create `useDashboard.ts`
   - [ ] Query 1: Total vendas (m√™s atual, closed_won)
   - [ ] Query 2: Oportunidades abertas (n√£o won/lost)
   - [ ] Query 3: Taxa convers√£o (won / total)
   - [ ] Query 4: Ticket m√©dio (avg value closed_won)
   - [ ] Query 5: Vendas por dia/m√™s (time series)
   - [ ] Query 6: Oportunidades por est√°gio (group by)
   - [ ] Query 7: √öltimas 5 oportunidades

2. **Stat Cards Integration** (1 dia):
   - [ ] Connect StatsGrid to `useDashboard`
   - [ ] Display real values
   - [ ] Add trend calculation (compare to previous period)
   - [ ] Add loading skeletons

3. **Charts** (2 dias):
   - [ ] Install `recharts`
   - [ ] Create RevenueChart (line chart)
   - [ ] Create PipelineChart (bar or pie chart)
   - [ ] Make responsive (mobile: smaller height)
   - [ ] Add tooltips with details

4. **Filters** (1 dia):
   - [ ] Add period filter dropdown (7d, 30d, 90d, 1y)
   - [ ] Update queries on filter change
   - [ ] Persist filter in URL params (optional)

---

## üìä P0 Summary - MVP Completion

**Total Estimate**: 24-35 days (5-7 semanas)

**Milestone 1**: Sistema autenticado + CRUD b√°sico funcionando (P0.1 + P0.2 + P0.3) - 13-19 dias
**Milestone 2**: Funil de Vendas visual operacional (P0.4) - +7-10 dias
**Milestone 3**: Dashboard com m√©tricas reais (P0.5) - +4-6 dias

**Checkpoint de Aprova√ß√£o**: Ap√≥s P0 completo, revisar com usu√°rio antes de prosseguir para P1.

---

## üöÄ Phase 2: P1 - HIGH PRIORITY (Weeks 7-14)

Essential for complete CRM operation.

---

## Feature: P1.6 - CRUD Produtos (Cat√°logo)

**Priority**: P1 (HIGH)
**Estimate**: 5-7 days
**Dependencies**: None (independent)
**Status**: ‚ùå Not Started (0%)

### Files to create/modify:

- [ ] `src/pages/Produtos.tsx` - TODO
- [ ] `src/components/organisms/ProductsTable.tsx` - TODO
- [ ] `src/components/organisms/ProdutoModal.tsx` - TODO
- [ ] `src/components/molecules/ProductCard.tsx` - TODO
- [ ] `src/hooks/useProdutos.ts` - TODO
- [ ] `supabase/migrations/005_create_products.sql` - TODO

### Checklist de Aceita√ß√£o:

- [ ] Formul√°rio de cadastro de produto
- [ ] Campos: nome, SKU, categoria (som/luz/estrutura), pre√ßo (BRL/USD/EUR), descri√ß√£o, imagem URL
- [ ] Listagem com filtros (categoria, faixa de pre√ßo)
- [ ] Busca por nome/SKU (real-time)
- [ ] Cards com imagem + pre√ßo
- [ ] Mobile: grid responsivo (1 ‚Üí 2 ‚Üí 3 colunas)
- [ ] Editar produto
- [ ] Desativar produto (soft delete - is_active = false)
- [ ] Upload de imagem (Supabase Storage)

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P1.6 - CRUD Produtos (Cat√°logo)" (linha 231)
- **GAP-ANALYSIS.md**: N√£o mencionado
- **FEATURES-PRIORITIZED.md**: Feature #6 (linha 49)

### Implementation Steps:

1. **Database Schema** (1 dia):
   - [ ] Create `products` table
   - [ ] Columns: id, name, sku, category, price_brl, price_usd, price_eur, description, image_url, stock_quantity, is_active
   - [ ] Add unique constraint on SKU
   - [ ] Add RLS policies
   - [ ] Configure Supabase Storage bucket for product images

2. **Supabase Hook** (2 dias):
   - [ ] Create `useProdutos.ts`
   - [ ] CRUD methods (get, create, update, delete)
   - [ ] Image upload to Storage
   - [ ] Filters and search

3. **Product Components** (2 dias):
   - [ ] Create ProdutoModal (form)
   - [ ] Create ProductCard (display)
   - [ ] Create ProductsTable (list)

4. **Image Upload** (1 dia):
   - [ ] File input with preview
   - [ ] Upload to Supabase Storage
   - [ ] Save URL to database
   - [ ] Handle errors (size limits, formats)

---

## Feature: P1.7 - Importa√ß√£o Excel (Produtos + Clientes)

**Priority**: P1 (HIGH)
**Estimate**: 5-7 days
**Dependencies**: P1.6 CRUD Produtos, P0.2 CRUD Clientes
**Status**: ‚ùå Not Started (0%)

### Files to create/modify:

- [ ] `src/pages/Importacao.tsx` - TODO
- [ ] `src/components/organisms/ExcelUploader.tsx` - TODO
- [ ] `src/components/organisms/ImportPreview.tsx` - TODO
- [ ] `src/hooks/useExcelImport.ts` - TODO
- [ ] Install: `xlsx` library

### Checklist de Aceita√ß√£o:

- [ ] Upload de arquivo Excel (.xlsx)
- [ ] Parsing com valida√ß√£o (detect columns automatically)
- [ ] Preview de dados antes de importar (first 10 rows)
- [ ] Valida√ß√£o de CNPJ (brasil-api-mcp)
- [ ] Report de erros (linhas inv√°lidas, quais campos)
- [ ] Import batch (Supabase insert batch - max 1000 rows)
- [ ] Progress bar durante importa√ß√£o
- [ ] Success/error summary ap√≥s importa√ß√£o
- [ ] Template Excel para download (header row example)

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P1.7 - Importa√ß√£o Excel (Produtos + Clientes)" (linha 246)
- **FEATURES-PRIORITIZED.md**: Feature #8 (linha 63)

### Implementation Steps:

1. **Excel Parser** (2 dias):
   - [ ] Install `xlsx` library
   - [ ] Parse uploaded file
   - [ ] Detect columns (match to expected fields)
   - [ ] Validate data types (number, string, date)
   - [ ] Create preview component

2. **Validation** (2 dias):
   - [ ] Validate CNPJ format (brasil-api-mcp)
   - [ ] Check for duplicates (SKU for products, CNPJ for clients)
   - [ ] Flag invalid rows
   - [ ] Show validation errors in preview

3. **Batch Insert** (2 dias):
   - [ ] Insert validated rows in batches (100 at a time)
   - [ ] Update progress bar
   - [ ] Handle errors (partial success)
   - [ ] Show final report (X inserted, Y failed)

4. **Template Download** (1 dia):
   - [ ] Generate Excel template with headers
   - [ ] Add example rows
   - [ ] Download button

---

## Feature: P1.8 - Sistema de Cota√ß√µes

**Priority**: P1 (HIGH)
**Estimate**: 8-10 days
**Dependencies**: P1.6 CRUD Produtos, P0.2 CRUD Clientes
**Status**: ‚ùå Not Started (0%)

### Files to create/modify:

- [ ] `src/pages/Cotacoes.tsx` - TODO
- [ ] `src/components/organisms/CotacaoForm.tsx` - TODO
- [ ] `src/components/organisms/CotacaoPDF.tsx` - TODO
- [ ] `src/hooks/useCotacoes.ts` - TODO
- [ ] `supabase/migrations/006_create_quotes.sql` - TODO
- [ ] Install: `@react-pdf/renderer` or `jspdf`

### Checklist de Aceita√ß√£o:

- [ ] Formul√°rio: selecionar cliente, adicionar produtos (multi-select)
- [ ] Campos por produto: quantidade, desconto (%)
- [ ] C√°lculo autom√°tico: subtotal, desconto total, frete, ICMS, total
- [ ] Convers√£o de moeda (BRL/USD/EUR)
- [ ] Gera√ß√£o de PDF (react-pdf ou jsPDF)
- [ ] Template PDF com logo STAGETEK, dados cliente, produtos, totais
- [ ] Envio por email (Resend API) - opcional aqui, pode ser P1.10
- [ ] Hist√≥rico de cota√ß√µes por cliente
- [ ] Status: Rascunho, Enviada, Aceita, Rejeitada, Expirada
- [ ] Data de validade (auto-calculated: hoje + 15 dias)
- [ ] N√∫mero sequencial (auto: COT-2025-001)

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P1.8 - Sistema de Cota√ß√µes" (linha 262)
- **GAP-ANALYSIS.md**: N√£o mencionado (mas cr√≠tico)
- **FEATURES-PRIORITIZED.md**: Feature #7 (linha 56)

### Implementation Steps:

1. **Database Schema** (1 dia):
   - [ ] Create `quotes` table
   - [ ] Columns: id, quote_number, client_id, items (JSONB), subtotal, discount, shipping, tax, total, currency, status, valid_until, pdf_url, created_by
   - [ ] Add RLS policies

2. **Quote Form** (3 dias):
   - [ ] Create CotacaoForm (multi-step?)
   - [ ] Step 1: Select client
   - [ ] Step 2: Add products (quantity, discount)
   - [ ] Step 3: Add shipping, tax, notes
   - [ ] Real-time calculation of totals
   - [ ] Currency selector (BRL/USD/EUR)

3. **PDF Generation** (3 dias):
   - [ ] Install `@react-pdf/renderer`
   - [ ] Create PDF template
   - [ ] Logo STAGETEK (from public assets)
   - [ ] Client info section
   - [ ] Products table (name, qty, unit price, total)
   - [ ] Totals section (subtotal, discount, shipping, tax, grand total)
   - [ ] Generate PDF blob
   - [ ] Upload to Supabase Storage
   - [ ] Save URL to database

4. **Quote Management** (2 dias):
   - [ ] List of quotes (table)
   - [ ] Filters: status, client, date
   - [ ] View/download PDF
   - [ ] Change status (accept/reject)
   - [ ] Duplicate quote (create new from existing)

---

## Feature: P1.9 - Sistema de Pedidos (Tracking)

**Priority**: P1 (HIGH)
**Estimate**: 7-10 days
**Dependencies**: P1.8 Sistema de Cota√ß√µes
**Status**: ‚ùå Not Started (0%)

### Files to create/modify:

- [ ] `src/pages/Pedidos.tsx` - TODO
- [ ] `src/components/organisms/PedidoTimeline.tsx` - TODO
- [ ] `src/components/organisms/PedidoModal.tsx` - TODO
- [ ] `src/hooks/usePedidos.ts` - TODO
- [ ] `supabase/migrations/007_create_orders.sql` - TODO

### Checklist de Aceita√ß√£o:

- [ ] Criar pedido a partir de cota√ß√£o aprovada (convert quote ‚Üí order)
- [ ] Status: Rascunho, Confirmado, Em Produ√ß√£o, Despachado, Entregue, Cancelado
- [ ] Timeline visual (stepper component - shadcn/ui)
- [ ] Campos: production_start_date, estimated_delivery_date, actual_delivery_date, tracking_code
- [ ] Notifica√ß√µes Slack quando status muda (P1.10)
- [ ] Anexos (NF, comprovante de envio) - upload to Supabase Storage
- [ ] Filtros: status, cliente, per√≠odo
- [ ] N√∫mero sequencial (PED-2025-001)
- [ ] Mobile: timeline horizontal scrollable

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P1.9 - Sistema de Pedidos (Tracking)" (linha 277)
- **FEATURES-PRIORITIZED.md**: Feature #11 (linha 88)

### Implementation Steps:

1. **Database Schema** (1 dia):
   - [ ] Create `orders` table
   - [ ] Columns: id, order_number, quote_id, client_id, items (JSONB), total, currency, status, production_start_date, estimated_delivery_date, actual_delivery_date, tracking_code, notes
   - [ ] Create `order_attachments` table (for NF, files)
   - [ ] Add RLS policies

2. **Convert Quote to Order** (2 dias):
   - [ ] Add "Converter em Pedido" button to quote details
   - [ ] Copy quote data to new order
   - [ ] Set initial status: Confirmado
   - [ ] Update quote status: Aceita

3. **Order Timeline** (3 dias):
   - [ ] Create PedidoTimeline component
   - [ ] Stepper: Rascunho ‚Üí Confirmado ‚Üí Em Produ√ß√£o ‚Üí Despachado ‚Üí Entregue
   - [ ] Show dates for each step
   - [ ] Clickable steps to update status
   - [ ] Mobile: horizontal scroll

4. **File Attachments** (2 dias):
   - [ ] Upload NF (PDF)
   - [ ] Upload comprovante (PDF, image)
   - [ ] List attachments
   - [ ] Download attachments

---

## Feature: P1.10 - Integra√ß√µes (Gmail, Slack, Calendar)

**Priority**: P1 (HIGH)
**Estimate**: 6-8 days
**Dependencies**: P1.8 Cota√ß√µes, P1.9 Pedidos
**Status**: ‚ùå Not Started (0%)

### Files to create/modify:

- [ ] `src/lib/resend.ts` - TODO (Resend API client)
- [ ] `src/lib/slack.ts` - TODO (Slack Webhook)
- [ ] `src/lib/google-calendar.ts` - TODO (Google Calendar API)
- [ ] `src/pages/Configuracoes.tsx` - TODO (settings page)
- [ ] `.env` - Add API keys

### Checklist de Aceita√ß√£o:

- [ ] **Resend API**: envio de emails (cota√ß√µes, follow-ups)
- [ ] Email templates (cota√ß√£o enviada, pedido confirmado)
- [ ] **Slack Webhook**: notifica√ß√µes (novo lead, pedido confirmado, deal fechado)
- [ ] Configurar webhook URL em settings
- [ ] **Google Calendar API**: criar eventos a partir de oportunidades
- [ ] Sync eventos: data esperada de fechamento ‚Üí Calendar event
- [ ] Log de emails enviados (activity_log table)
- [ ] Settings page para configurar webhooks e API keys

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P1.10 - Integra√ß√µes (Gmail, Slack, Calendar)" (linha 292)
- **FEATURES-PRIORITIZED.md**: Features #9, #10, #14, #15 (linhas 70-122)

### Implementation Steps:

1. **Resend API Setup** (2 dias):
   - [ ] Install `resend` SDK
   - [ ] Create email templates (React Email or HTML)
   - [ ] Send quote email
   - [ ] Send order confirmation email
   - [ ] Log sent emails to activity_log

2. **Slack Integration** (2 dias):
   - [ ] Create Slack Webhook
   - [ ] Send notifications on:
     - [ ] New opportunity created
     - [ ] Deal closed (won)
     - [ ] Order confirmed
     - [ ] Order delivered
   - [ ] Format messages with rich text (blocks)

3. **Google Calendar Integration** (3 dias):
   - [ ] Setup Google Calendar API (OAuth or Service Account)
   - [ ] Create event when opportunity expected_close_date is set
   - [ ] Update event when date changes
   - [ ] Delete event when opportunity is lost
   - [ ] Store google_calendar_event_id in opportunities table

4. **Settings Page** (1 dia):
   - [ ] Add inputs for:
     - [ ] Slack Webhook URL
     - [ ] Resend API Key
     - [ ] Google Calendar credentials
   - [ ] Test buttons (send test notification)
   - [ ] Save to .env or Supabase secrets

---

## üìä P1 Summary - Functional CRM

**Total Estimate**: 31-42 days (6-8 semanas)

**Milestone 4**: Cat√°logo de produtos + Importa√ß√£o (P1.6 + P1.7) - 10-14 dias
**Milestone 5**: Sistema de cota√ß√µes + pedidos (P1.8 + P1.9) - 15-20 dias
**Milestone 6**: Integra√ß√µes ativas (P1.10) - 6-8 dias

**Checkpoint de Aprova√ß√£o**: CRM completo funcional. Revisar com usu√°rio antes de P2.

---

## üéØ Phase 3: P2 - MEDIUM PRIORITY (Weeks 15-18)

Advanced management features.

---

## Feature: P2.11 - Relat√≥rios Gerenciais

**Priority**: P2 (MEDIUM)
**Estimate**: 7-10 days
**Dependencies**: P0.3 Oportunidades, P1.8 Cota√ß√µes, P1.9 Pedidos (data hist√≥rico)
**Status**: ‚ùå Not Started (0%)

### Files to create/modify:

- [ ] `src/pages/Relatorios.tsx` - TODO
- [ ] `src/components/organisms/ConversionFunnelChart.tsx` - TODO
- [ ] `src/components/organisms/DREReport.tsx` - TODO
- [ ] `src/hooks/useRelatorios.ts` - TODO

### Checklist de Aceita√ß√£o:

- [ ] Relat√≥rio de convers√£o (funil completo: leads ‚Üí won)
- [ ] DRE simplificado (receitas, custos, margem)
- [ ] An√°lise por categoria de produto
- [ ] An√°lise por vendedor (assigned_to)
- [ ] Exportar para Excel/PDF
- [ ] Agendamento de relat√≥rios (envio autom√°tico Slack) - opcional
- [ ] Filtros: per√≠odo, vendedor, categoria

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P2.11 - Relat√≥rios Gerenciais" (linha 311)
- **FEATURES-PRIORITIZED.md**: Feature #16 (linha 123)

---

## Feature: P2.12 - Gest√£o de Equipamentos (Estoque)

**Priority**: P2 (MEDIUM)
**Estimate**: 5-7 days
**Dependencies**: P1.6 CRUD Produtos
**Status**: ‚ùå Not Started (0%)

### Files to create/modify:

- [ ] `src/pages/Equipamentos.tsx` - TODO
- [ ] `src/components/organisms/EquipmentTable.tsx` - TODO
- [ ] `src/hooks/useEquipamentos.ts` - TODO
- [ ] `supabase/migrations/008_create_equipments.sql` - TODO

### Checklist de Aceita√ß√£o:

- [ ] CRUD de equipamentos (vinculados a produtos)
- [ ] Status: Dispon√≠vel, Em Uso, Manuten√ß√£o, Inativo
- [ ] Calend√°rio de uso (timeline)
- [ ] Reservas (vincular a eventos/oportunidades)
- [ ] Hist√≥rico de manuten√ß√µes (table)
- [ ] Alertas de manuten√ß√£o preventiva (next_maintenance_date)

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P2.12 - Gest√£o de Equipamentos (Estoque)" (linha 326)
- **FEATURES-PRIORITIZED.md**: Feature #12 (linha 95)

---

## Feature: P2.13 - Calend√°rio de Eventos

**Priority**: P2 (MEDIUM)
**Estimate**: 5-7 days
**Dependencies**: P2.12 Equipamentos
**Status**: ‚ùå Not Started (0%)

### Files to create/modify:

- [ ] `src/pages/Eventos.tsx` - TODO
- [ ] `src/components/organisms/EventCalendar.tsx` - TODO
- [ ] `src/hooks/useEventos.ts` - TODO
- [ ] `supabase/migrations/009_create_events.sql` - TODO
- [ ] Install: `react-big-calendar` (lightweight, 50KB)

### Checklist de Aceita√ß√£o:

- [ ] Calend√°rio mensal (react-big-calendar)
- [ ] Criar evento vinculado a oportunidade
- [ ] Drag-and-drop de eventos (reschedule)
- [ ] Cores por status (confirmado, pendente, cancelado)
- [ ] Sincroniza√ß√£o com Google Calendar (P1.10)
- [ ] Filtros: por cliente, por equipamento
- [ ] Mobile: view m√™s/semana/dia

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P2.13 - Calend√°rio de Eventos" (linha 341)
- **FEATURES-PRIORITIZED.md**: Feature #13 (linha 102)

---

## Feature: P2.14 - Lead Scoring com IA

**Priority**: P2 (MEDIUM)
**Estimate**: 7-10 days
**Dependencies**: Claude API, hist√≥rico de convers√µes (P0.3 data)
**Status**: ‚ùå Not Started (0%)

### Files to create/modify:

- [ ] `src/lib/claude.ts` - TODO (Claude API client)
- [ ] `supabase/functions/lead-scoring/index.ts` - TODO (Edge Function)
- [ ] `src/hooks/useLeadScoring.ts` - TODO
- [ ] `.env` - Add CLAUDE_API_KEY

### Checklist de Aceita√ß√£o:

- [ ] Claude API para an√°lise de leads
- [ ] Score 0-100 baseado em:
  - [ ] Valor do deal (20 pontos)
  - [ ] Hist√≥rico do cliente (20 pontos)
  - [ ] Tempo no funil (10 pontos)
  - [ ] Engagement (15 pontos - emails, tarefas)
- [ ] Temperatura: üî• Hot (>70), üå°Ô∏è Warm (40-70), üßä Cold (<40)
- [ ] Atualiza√ß√£o autom√°tica a cada 24h (Supabase Edge Function cron)
- [ ] Insights textuais ("Lead inativo h√° 15 dias, enviar follow-up")
- [ ] Dashboard com top 10 leads quentes

### Rastreabilidade:

- **PRD.md**: Se√ß√£o "P2.14 - Lead Scoring com IA" (linha 356)
- **FEATURES-PRIORITIZED.md**: Feature #17 (linha 133)

---

## üìä P2 Summary - Advanced Management

**Total Estimate**: 24-34 days (5-7 semanas)

**Milestone 7**: Relat√≥rios + Equipamentos + Calend√°rio (P2.11-13) - 17-24 dias
**Milestone 8**: IA Lead Scoring ativo (P2.14) - 7-10 dias

**Checkpoint de Aprova√ß√£o**: Sistema com an√°lise inteligente. Avaliar ROI antes de P3.

---

## ü§ñ Phase 4: P3 - LOW PRIORITY / AI Features (Weeks 19+)

Nice to have features. **Recomenda√ß√£o**: Adiar para Ano 2.

**Features**:
- P3.15 - AI SDR (Bot WhatsApp 24/7) - ‚ö†Ô∏è COMPLEXO, ROI incerto
- P3.16 - Call Recording + AI Analysis - ‚ö†Ô∏è Riscos LGPD
- P3.17 - Multi-idioma (EN, ES) - ‚è∏Ô∏è Adiar
- P3.18 - Mobile App Nativo - ‚ùå Usar PWA ao inv√©s

**Rastreabilidade**: PRD.md se√ß√£o "P3 - BAIXA PRIORIDADE" (linha 374)

---

## üìÖ Recommended Implementation Order

### **Option 1: Priority-Based (Recommended)**

**Best for**: Delivering business value incrementally.

```
Week 1: P0.1 Authentication (5 days)
Week 2: P0.2 CRUD Clientes (5 days)
Week 3: P0.3 CRUD Oportunidades (5 days)
Week 4-5: P0.4 Funil Kanban (10 days)
Week 6: P0.5 Dashboard (5 days)
---
Checkpoint 1: MVP Review with user
---
Week 7-8: P1.6 Produtos + P1.7 Importa√ß√£o (12 days)
Week 9-10: P1.8 Cota√ß√µes (10 days)
Week 11-12: P1.9 Pedidos (10 days)
Week 13: P1.10 Integra√ß√µes (7 days)
---
Checkpoint 2: Functional CRM Review
---
Week 14-15: P2.11 Relat√≥rios (10 days)
Week 16: P2.12 Equipamentos (7 days)
Week 17: P2.13 Calend√°rio (7 days)
Week 18-19: P2.14 Lead Scoring (10 days)
---
Checkpoint 3: Advanced Features Review
---
```

**Total: 19 weeks (95 days)**

---

### **Option 2: Feature Vertical (Full Feature at a Time)**

**Best for**: Testing complete workflows early.

```
Vertical 1: Sales Pipeline (Weeks 1-5)
  - P0.1 Auth
  - P0.2 Clientes
  - P0.3 Oportunidades
  - P0.4 Funil Kanban
  - P0.5 Dashboard

Vertical 2: Quotations & Orders (Weeks 6-10)
  - P1.6 Produtos
  - P1.8 Cota√ß√µes
  - P1.9 Pedidos
  - P1.10 Integra√ß√µes (email)

Vertical 3: Management & Analytics (Weeks 11-14)
  - P2.11 Relat√≥rios
  - P2.12 Equipamentos
  - P2.13 Calend√°rio
  - P2.14 Lead Scoring
```

---

### **Option 3: Quick Wins First (MVF - Minimum Viable Features)**

**Best for**: Getting user buy-in fast.

```
Week 1-2: Quick Setup (10 days)
  - P0.1 Auth
  - P0.2 Clientes (basic CRUD)
  - P0.5 Dashboard (static mockups)

Week 3-4: Core Sales (10 days)
  - P0.3 Oportunidades (basic CRUD)
  - P0.4 Funil Kanban (no filters, basic drag-drop)

Week 5-6: Revenue Generation (10 days)
  - P1.6 Produtos (basic CRUD)
  - P1.8 Cota√ß√µes (PDF generation)

---
User Demo & Feedback
---

Week 7+: Iterate based on feedback
```

---

## üéØ Approval Checkpoints

Critical decision points where USER MUST review before proceeding.

### **Checkpoint 1: Post-MVP (After P0)**

**When**: After P0.5 Dashboard is complete
**Duration**: 1-2 days of testing

**Review Criteria**:
- [ ] Can login/logout successfully
- [ ] Can create/edit/list clients
- [ ] Can create/edit/list opportunities
- [ ] Kanban drag-and-drop works on desktop AND mobile
- [ ] Dashboard shows real metrics
- [ ] Mobile experience is acceptable

**Go/No-Go Decision**:
- ‚úÖ **GO**: Proceed to P1 (products, quotes, orders)
- ‚ùå **NO-GO**: Fix critical bugs, improve UX, re-test

---

### **Checkpoint 2: Post-Functional CRM (After P1)**

**When**: After P1.10 Integra√ß√µes is complete
**Duration**: 3-5 days of testing

**Review Criteria**:
- [ ] Product catalog is usable
- [ ] Can import data from Excel
- [ ] Can create quotes and generate PDF
- [ ] Can convert quote ‚Üí order
- [ ] Email/Slack/Calendar integrations work
- [ ] End-to-end workflow: Lead ‚Üí Quote ‚Üí Order ‚Üí Delivery

**Go/No-Go Decision**:
- ‚úÖ **GO**: Proceed to P2 (advanced features)
- ‚è∏Ô∏è **PAUSE**: Use in production for 2-4 weeks, gather feedback
- ‚ùå **NO-GO**: Fix issues, optimize performance

---

### **Checkpoint 3: Post-Advanced Features (After P2)**

**When**: After P2.14 Lead Scoring is complete
**Duration**: 1 week of testing

**Review Criteria**:
- [ ] Reports provide business insights
- [ ] Equipment management is useful
- [ ] Calendar prevents conflicts
- [ ] Lead scoring helps prioritize
- [ ] AI insights are actionable

**Go/No-Go Decision**:
- ‚úÖ **GO**: Consider P3 features (AI SDR, etc.)
- ‚è∏Ô∏è **PAUSE**: Focus on adoption, training, optimization
- ‚ùå **STOP**: Do NOT proceed to P3 (low ROI)

---

## üö® Risk Mitigation Strategies

### **Risk 1: Supabase Free Tier Limits**

**Trigger**: Approaching 80% of 500MB database or 2GB storage
**Probability**: üü° Medium (Year 1)
**Impact**: üî¥ High (system stops working)

**Mitigation**:
1. **Monitor weekly** via Supabase Dashboard
2. **Implement data cleanup**:
   - [ ] Archive opportunities older than 12 months (move to `archived_opportunities` table)
   - [ ] Delete activity_log entries older than 6 months
   - [ ] Compress images before upload (max 500KB)
3. **Plan upgrade**: Budget for Supabase Pro ($25/month) if needed

---

### **Risk 2: Protocol Notecraft‚Ñ¢ Line Limits**

**Trigger**: Complex component exceeds 50 lines
**Probability**: üü° Medium
**Impact**: üü¢ Low (refactor required)

**Mitigation**:
1. **Use composition**: Break into smaller components
2. **Extract hooks**: Move logic to custom hooks
3. **Accept exceptions**: Document why component is >50 lines (valid reason)

**Example**:
```tsx
// ‚ùå BAD: FunilVendas.tsx (120 lines)

// ‚úÖ GOOD: Split into:
// - FunilVendas.tsx (30 lines) - layout wrapper
// - KanbanBoard.tsx (50 lines) - board logic
// - KanbanColumn.tsx (35 lines) - column
// - OpportunityCard.tsx (35 lines) - card
// - useFunil.ts (hook) - data fetching
```

---

### **Risk 3: Mobile Drag-and-Drop UX**

**Trigger**: dnd-kit doesn't work well on mobile
**Probability**: üü° Medium
**Impact**: üü° Medium (degraded UX)

**Mitigation**:
1. **Test early**: Test on real Android + iOS devices in Week 4
2. **Fallback UI**: Add "Mover para..." buttons on mobile if drag fails
3. **Alternative library**: Consider `react-beautiful-dnd` if dnd-kit fails

---

### **Risk 4: Timeline Overrun (Scope Creep)**

**Trigger**: User requests "just one more feature"
**Probability**: üî¥ High (natural behavior)
**Impact**: üü° Medium (delays launch)

**Mitigation**:
1. **Strict prioritization**: Refer to this document
2. **Feature backlog**: Add to P3 or "Future" list
3. **Weekly check-ins**: Review progress vs. plan
4. **Kill scope**: If >20% behind, remove P2 features

---

## üìä Progress Tracking

### **Weekly Progress Report Template**

```markdown
## Week X Progress Report

**Completed**:
- ‚úÖ Feature X (3 days, on schedule)
- ‚úÖ Feature Y (5 days, 1 day over estimate)

**In Progress**:
- üîÑ Feature Z (70% complete, on track)

**Blockers**:
- ‚ö†Ô∏è Supabase RLS policy not working (investigating)

**Next Week**:
- [ ] Complete Feature Z
- [ ] Start Feature A
- [ ] Test mobile UX

**Risks**:
- üü° Behind schedule by 2 days (acceptable)
```

---

### **Burndown Chart (Track P0 Progress)**

| Feature | Estimate | Actual | Status |
|---------|----------|--------|--------|
| P0.1 Auth | 5 days | TBD | ‚ùå Not Started |
| P0.2 Clientes | 7 days | TBD | ‚ùå Not Started |
| P0.3 Oportunidades | 7 days | TBD | ‚ùå Not Started |
| P0.4 Funil Kanban | 10 days | TBD | ‚ùå Not Started |
| P0.5 Dashboard | 6 days | TBD | ‚ùå Not Started |
| **TOTAL P0** | **35 days** | **0 days** | **0%** |

---

## üéì Knowledge Transfer & Documentation

### **User Documentation** (Create during development)

- [ ] `docs/USER-GUIDE.md` - How to use the CRM
- [ ] `docs/ADMIN-GUIDE.md` - How to configure integrations
- [ ] `docs/FAQ.md` - Frequently asked questions
- [ ] `docs/TROUBLESHOOTING.md` - Common issues and fixes

### **Developer Documentation** (Maintain as you code)

- [ ] `docs/ARCHITECTURE.md` - Already exists, keep updated
- [ ] `docs/COMPONENT-LIBRARY.md` - Storybook or manual docs
- [ ] `docs/API-REFERENCE.md` - Supabase schema + hooks
- [ ] `docs/DEPLOYMENT.md` - How to deploy to Vercel

### **Training Plan** (Week 18-19)

1. **Admin Training** (2 hours):
   - Setup Supabase, Resend, Slack integrations
   - Configure funis, produtos, usu√°rios
   - Import data from Excel

2. **User Training** (3 hours):
   - Login, navega√ß√£o
   - CRUD Clientes, Oportunidades
   - Funil Kanban (drag-and-drop)
   - Criar cota√ß√µes e pedidos
   - Dashboard e relat√≥rios

---

## ‚úÖ Definition of Done (DoD)

For each feature to be considered "complete":

- [ ] **Code**:
  - [ ] All files created/modified as specified
  - [ ] TypeScript strict mode (no `any`)
  - [ ] Protocol Notecraft‚Ñ¢ line limits followed
  - [ ] Tailwind CSS (no inline styles)
  - [ ] Components use STAGETEK design tokens

- [ ] **Functionality**:
  - [ ] All acceptance criteria met
  - [ ] Works on desktop (Chrome, Firefox, Safari)
  - [ ] Works on mobile (iOS Safari, Android Chrome)
  - [ ] Dark mode supported

- [ ] **Quality**:
  - [ ] No console errors
  - [ ] Loading states for async operations
  - [ ] Error handling (try/catch, display errors)
  - [ ] Form validation works
  - [ ] Lighthouse score >85 (performance, accessibility)

- [ ] **Data**:
  - [ ] Supabase schema migrated
  - [ ] RLS policies created and tested
  - [ ] Sample data seeded for testing

- [ ] **Documentation**:
  - [ ] Code comments for complex logic
  - [ ] User-facing feature documented in USER-GUIDE.md
  - [ ] Component added to Storybook (if applicable)

- [ ] **Review**:
  - [ ] Tested by developer
  - [ ] Tested by user (if checkpoint)
  - [ ] Approved by Product Manager (you)

---

## üèÅ Final Deliverables (End of Phase 2)

After completing P0 + P1 + P2, the system will have:

### **User-Facing Features**:
- ‚úÖ Authentication (login/logout/recovery)
- ‚úÖ CRUD Clientes (with CNPJ autocomplete)
- ‚úÖ CRUD Oportunidades (with qualification)
- ‚úÖ Funil de Vendas Kanban (drag-and-drop)
- ‚úÖ Dashboard (real metrics)
- ‚úÖ CRUD Produtos (catalog)
- ‚úÖ Importa√ß√£o Excel
- ‚úÖ Sistema de Cota√ß√µes (PDF generation)
- ‚úÖ Sistema de Pedidos (tracking)
- ‚úÖ Integra√ß√µes (Email, Slack, Calendar)
- ‚úÖ Relat√≥rios Gerenciais
- ‚úÖ Gest√£o de Equipamentos
- ‚úÖ Calend√°rio de Eventos
- ‚úÖ Lead Scoring com IA

### **Technical Deliverables**:
- ‚úÖ React 18 + TypeScript app (Vite)
- ‚úÖ Supabase backend (PostgreSQL + Auth + Storage)
- ‚úÖ Tailwind CSS + STAGETEK design system
- ‚úÖ Atomic Design components (atoms/molecules/organisms)
- ‚úÖ Mobile-first PWA (installable)
- ‚úÖ Vercel deployment (auto-deploy from GitHub)
- ‚úÖ RLS policies (secure data)
- ‚úÖ Integrations (Resend, Slack, Google Calendar, Claude API)

### **Documentation**:
- ‚úÖ User Guide
- ‚úÖ Admin Guide
- ‚úÖ Developer Documentation
- ‚úÖ Architecture Diagrams
- ‚úÖ API Reference (Supabase schema + hooks)

---

## üöÄ Success Criteria

The implementation is **successful** if:

1. **All P0 + P1 features** are complete and working
2. **5 usu√°rios** can use the system daily without major issues
3. **Mobile experience** is acceptable (Lighthouse >85)
4. **Data is secure** (RLS policies tested)
5. **System is fast** (<3s page load, <1s interactions)
6. **User training** is complete (team knows how to use)
7. **Adoption rate** >80% in first month
8. **Zero critical bugs** in production

---

**Built with ‚ù§Ô∏è following Protocol Notecraft‚Ñ¢**
**STAGETEK Engineering Team**
**Data**: 3 de Outubro de 2025

**Next Steps**:
1. ‚úÖ Review and approve this implementation plan
2. üîÑ Begin P0.1 Authentication (Week 1)
3. üìÖ Schedule weekly check-ins
4. üìä Setup progress tracking (GitHub Projects or Trello)
