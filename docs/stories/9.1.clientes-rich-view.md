# Story 9.1: Clientes Rich View - 3 Fases

**Epic**: EPIC-009 | **Status**: Draft | **Prioridade**: P1 | **Estimativa**: 2 dias
**UX Owner**: Sally (UX Expert) | **Dev Owner**: Dev Team

---

## ğŸ“‹ User Story

> **Como** gestor comercial
> **Quero** ver informaÃ§Ãµes completas e visuais dos meus clientes B2B
> **Para** tomar decisÃµes rÃ¡pidas, entender o relacionamento e identificar oportunidades

---

## ğŸ¯ Problema Atual

A tela `/clientes` estÃ¡ **funcionalmente pobre**:

### âŒ Desktop (ClientTable):
- Tabela mostra apenas: Nome, CNPJ, Email, Phone, Status
- NÃ£o aproveita dados: EndereÃ§o, Website, Oportunidades, MÃ©tricas
- Visual corporativo, mas pouco informativo

### âŒ Mobile (ClientCard):
- Card bÃ¡sico: Nome, CNPJ, Email, Phone
- NÃ£o mostra cidade, website, stats
- DesperdiÃ§a espaÃ§o vertical

### âŒ Sem Detalhes:
- NÃ£o existe `/clientes/:id` (detalhe individual)
- Para ver oportunidades do cliente â†’ precisa ir para `/oportunidades` e filtrar
- Nenhuma mÃ©trica visual (valor total, taxa conversÃ£o)

---

## ğŸ¨ SoluÃ§Ã£o: 3 Fases Incrementais

### **Fase 1: Enriquecer ClientCard Mobile** (4h)
Adicionar dados ao card atual sem quebrar layout existente.

### **Fase 2: PÃ¡gina DetalheCliente** (1 dia)
Criar `/clientes/:id` com layout 3 colunas + tabs (igual Oportunidades).

### **Fase 3: Grid View Desktop** (4h)
Substituir tabela desktop por grid de cards ricos (estilo Pinterest).

---

## ğŸ“ FASE 1: ClientCard Enriquecido (4h)

### Acceptance Criteria:

#### AC 1.1: Adicionar SeÃ§Ã£o "LocalizaÃ§Ã£o"
- [ ] Mostrar cidade + estado (ex: "SÃ£o Paulo, SP")
- [ ] Ãcone MapPin (Lucide)
- [ ] Se nÃ£o tiver endereÃ§o â†’ mostrar "Sem localizaÃ§Ã£o"
- [ ] Cor: text-gray-400 (secundÃ¡ria)

#### AC 1.2: Adicionar SeÃ§Ã£o "Website"
- [ ] Mostrar website se existir
- [ ] Ãcone Globe (Lucide)
- [ ] Link clicÃ¡vel (`target="_blank"`)
- [ ] Truncar se muito longo (max-w-full truncate)

#### AC 1.3: Adicionar Mini-Stats
- [ ] Badge "X oportunidades" (query count)
- [ ] Badge "R$ Y total" (soma opportunity.value onde client_id = cliente.id)
- [ ] Badges pequenos, cor neutra (bg-white/5)
- [ ] Stack horizontal (flex gap-2)

#### AC 1.4: Visual Polish
- [ ] Manter â‰¤50 linhas (molecule)
- [ ] Glassmorphism mantido (backdrop-blur-sm)
- [ ] Responsivo: stack vertical em mobile pequeno (<375px)

### Design Spec (Before/After):

```
âŒ ANTES (BÃ¡sico):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Festival Music BR      [Ativo] â”‚
â”‚ 12.345.678/0001-99             â”‚
â”‚ âœ‰ï¸ cont***@festival.com        â”‚
â”‚ ğŸ“ (11) 9****-1234             â”‚
â”‚         [âœï¸ Editar] [ğŸ—‘ï¸ Excluir] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… DEPOIS (Rico):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Festival Music BR      [Ativo] â”‚
â”‚ 12.345.678/0001-99             â”‚
â”‚ âœ‰ï¸ cont***@festival.com        â”‚
â”‚ ğŸ“ (11) 9****-1234             â”‚
â”‚ ğŸ“ SÃ£o Paulo, SP               â”‚
â”‚ ğŸŒ festival.com.br             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ [5 oportunidades] [R$ 125K]    â”‚ â† Stats
â”‚         [âœï¸ Editar] [ğŸ—‘ï¸ Excluir] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tasks:

1. [ ] **[1h]** Criar hook `useClientStats(clientId)`
   - Query: `SELECT COUNT(*), SUM(value) FROM opportunities WHERE client_id = ?`
   - Return: `{ opportunityCount, totalValue }`

2. [ ] **[2h]** Atualizar `ClientCard.tsx` (â‰¤50 linhas)
   - Adicionar seÃ§Ã£o LocalizaÃ§Ã£o (city + state)
   - Adicionar seÃ§Ã£o Website (link)
   - Adicionar mini-stats (badges)
   - Refatorar classes (DRY)

3. [ ] **[1h]** Testar + Polish
   - Mobile: 375px, 414px
   - Edge cases: Cliente sem endereÃ§o, sem website, sem oportunidades
   - Performance: stats devem carregar via query otimizada

---

## ğŸ“ FASE 2: PÃ¡gina DetalheCliente (1 dia)

### Acceptance Criteria:

#### AC 2.1: Rota `/clientes/:id`
- [ ] Rota criada no React Router
- [ ] Breadcrumb: "Clientes > [Nome Cliente]"
- [ ] BotÃ£o "Voltar" (ArrowLeft icon)
- [ ] Loading state (Spinner)
- [ ] Not found: "Cliente nÃ£o encontrado"

#### AC 2.2: Layout 3 Colunas (Desktop)
- [ ] **Sidebar Esquerda (col-span-3)**: Dados do Cliente
  - Nome (h1)
  - CNPJ
  - Status badge
  - Contato: Email + Phone (clicÃ¡veis)
  - EndereÃ§o completo (card)
  - Website (link externo)
  - Datas: Criado em, Atualizado em

- [ ] **Ãrea Central (col-span-6)**: Tabs
  - Tab "Oportunidades": Lista oportunidades do cliente
  - Tab "Documentos": Upload de contratos/NFs (reutilizar FileManager)
  - Tab "HistÃ³rico": Timeline de interaÃ§Ãµes (notas, emails, tarefas)
  - Tab "Contatos": Lista de contatos (pessoas) do cliente

- [ ] **Sidebar Direita (col-span-3)**: MÃ©tricas & Actions
  - Card "EstatÃ­sticas":
    - Total oportunidades (count)
    - Valor total negociado (sum)
    - Taxa de conversÃ£o (won / total)
    - Ticket mÃ©dio (avg)
  - Card "AÃ§Ãµes RÃ¡pidas":
    - BotÃ£o "Nova Oportunidade"
    - BotÃ£o "Enviar Email"
    - BotÃ£o "Ver no Mapa" (Google Maps)
    - BotÃ£o "Abrir Website"

#### AC 2.3: Mobile Responsive
- [ ] Layout vertical: Dados â†’ Tabs â†’ MÃ©tricas
- [ ] Tabs grid 2x2 (4 tabs visÃ­veis)
- [ ] Dropdown "AÃ§Ãµes" mobile (MoreVertical)

#### AC 2.4: Tab Oportunidades
- [ ] Lista oportunidades WHERE client_id = :id
- [ ] Mostra: TÃ­tulo, Valor, EstÃ¡gio, Status
- [ ] Click â†’ navega para `/oportunidades/:oppId`
- [ ] Empty state: "Nenhuma oportunidade. Criar primeira?"
- [ ] BotÃ£o "+ Nova Oportunidade" inline

### Design Reference:

**Layout Desktop:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Voltar | Clientes > Festival Music BR                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SIDEBAR  â”‚   TABS (Oportunidades)        â”‚  MÃ‰TRICAS        â”‚
â”‚ LEFT     â”‚                               â”‚                  â”‚
â”‚          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ EstatÃ­sticas     â”‚
â”‚ Nome     â”‚ â”‚ Opp 1: Truss Q30 - R$50K â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚ CNPJ     â”‚ â”‚ [Proposta] [Aberta]      â”‚  â”‚ 5 Oportunidades  â”‚
â”‚ Status   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ R$ 125K total    â”‚
â”‚ â”€â”€â”€â”€â”€â”€   â”‚                               â”‚ 60% conversÃ£o    â”‚
â”‚ Contato  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ R$ 25K ticket    â”‚
â”‚ Email    â”‚ â”‚ Opp 2: Som Pioneer       â”‚  â”‚                  â”‚
â”‚ Phone    â”‚ â”‚ [NegociaÃ§Ã£o] [Aberta]    â”‚  â”‚ AÃ§Ãµes RÃ¡pidas    â”‚
â”‚ â”€â”€â”€â”€â”€â”€   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚ EndereÃ§o â”‚                               â”‚ [+ Nova Opp]     â”‚
â”‚ Rua X    â”‚ [+ Nova Oportunidade]         â”‚ [âœ‰ï¸ Email]       â”‚
â”‚ Cidade   â”‚                               â”‚ [ğŸ“ Mapa]        â”‚
â”‚ Website  â”‚                               â”‚ [ğŸŒ Site]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tasks:

1. [ ] **[2h]** Criar pÃ¡gina `DetalheCliente.tsx` (â‰¤100 linhas)
   - Rota React Router
   - Fetch cliente by ID
   - Layout 3 colunas (lg:grid-cols-12)
   - Breadcrumb + Voltar

2. [ ] **[2h]** Criar componente `ClientOpportunities.tsx` (â‰¤50 linhas)
   - Query opportunities WHERE client_id = :id
   - Lista cards simples (tÃ­tulo, valor, estÃ¡gio)
   - Empty state

3. [ ] **[2h]** Criar componente `ClientStats.tsx` (â‰¤50 linhas)
   - Card com 4 mÃ©tricas:
     - Total oportunidades (count)
     - Valor total (sum)
     - Taxa conversÃ£o (won/total * 100)
     - Ticket mÃ©dio (avg)
   - Ãcones Lucide: TrendingUp, DollarSign, Percent, BarChart3

4. [ ] **[2h]** Criar componente `ClientActions.tsx` (â‰¤50 linhas)
   - BotÃµes quick actions:
     - Nova Oportunidade â†’ modal OportunidadeModal prÃ©-preenchido
     - Enviar Email â†’ abre EmailComposer (reutilizar)
     - Ver no Mapa â†’ Google Maps link (latlong ou endereÃ§o)
     - Abrir Website â†’ window.open(cliente.website)

---

## ğŸ“ FASE 3: Grid View Desktop (4h)

### Acceptance Criteria:

#### AC 3.1: Toggle View (Desktop)
- [ ] BotÃ£o toggle "Tabela/Grid" no header (ao lado do "+ Novo Cliente")
- [ ] Ãcones: LayoutList (tabela) / LayoutGrid (grid)
- [ ] Estado salvo em localStorage (`clientsViewMode`)
- [ ] Default: Grid (novo visual)

#### AC 3.2: Grid Layout
- [ ] Desktop: `grid grid-cols-3 gap-6` (3 colunas)
- [ ] Tablet: `grid-cols-2` (2 colunas)
- [ ] Mobile: `grid-cols-1` (1 coluna = lista atual)

#### AC 3.3: ClientCard Desktop Rico
- [ ] Reutilizar ClientCard mobile, mas **expandido**
- [ ] Adicionar:
  - Avatar com iniciais (igual OpportunityCard)
  - Hover: ElevaÃ§Ã£o (shadow-2xl)
  - Click no card inteiro â†’ navega para `/clientes/:id`
  - BotÃµes Editar/Excluir no hover (canto superior direito)

#### AC 3.4: Visual Polish
- [ ] Hover scale: `hover:scale-105` (sutil)
- [ ] Transition smooth: `transition-all duration-300`
- [ ] Skeleton loading: 6 cards placeholder
- [ ] Glassmorphism mantido

### Design Spec:

```
GRID VIEW (Desktop):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cliente A    â”‚ Cliente B    â”‚ Cliente C    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ [FA]         â”‚ [PH]         â”‚ [ST]         â”‚ â† Avatar
â”‚ Festival     â”‚ Pollos       â”‚ STAGETEK     â”‚
â”‚ SÃ£o Paulo,SP â”‚ Curitiba,PR  â”‚ Rio, RJ      â”‚
â”‚ âœ‰ï¸ ğŸ“ ğŸŒ      â”‚ âœ‰ï¸ ğŸ“        â”‚ âœ‰ï¸ ğŸ“ ğŸŒ      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ 5 opps       â”‚ 2 opps       â”‚ 12 opps      â”‚
â”‚ R$ 125K      â”‚ R$ 30K       â”‚ R$ 450K      â”‚
â”‚              â”‚              â”‚              â”‚
â”‚      [âœï¸ ğŸ—‘ï¸]  â”‚      [âœï¸ ğŸ—‘ï¸]  â”‚      [âœï¸ ğŸ—‘ï¸]  â”‚ â† Hover only
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tasks:

1. [ ] **[1h]** Adicionar Toggle View ao header `Clientes.tsx`
   - BotÃ£o LayoutList/LayoutGrid
   - Estado `viewMode: 'table' | 'grid'` (localStorage)

2. [ ] **[2h]** Criar componente `ClientCardRich.tsx` (â‰¤60 linhas)
   - Baseado em ClientCard mobile, mas expandido
   - Avatar com iniciais (gradient STAGETEK)
   - Stats inline (oportunidades + valor)
   - Hover: botÃµes aparecem (absolute top-right)
   - Click card â†’ navega `/clientes/:id`

3. [ ] **[1h]** Implementar Grid Layout em `Clientes.tsx`
   - Conditional render: {viewMode === 'grid' ? <Grid /> : <Table />}
   - Grid: `grid-cols-1 md:grid-cols-2 lg:grid-cols-3`
   - Skeleton loading

---

## ğŸ—„ï¸ Queries & Dados

### Query 1: Client Stats
```typescript
// useClientStats.ts
const { data: stats } = useQuery({
  queryKey: ['client-stats', clientId],
  queryFn: async () => {
    const { data: opps } = await supabase
      .from('opportunities')
      .select('value, status')
      .eq('client_id', clientId)

    const total = opps?.length || 0
    const won = opps?.filter(o => o.status === 'won').length || 0
    const totalValue = opps?.reduce((sum, o) => sum + (o.value || 0), 0) || 0

    return {
      opportunityCount: total,
      totalValue,
      conversionRate: total > 0 ? (won / total) * 100 : 0,
      avgTicket: total > 0 ? totalValue / total : 0
    }
  }
})
```

### Query 2: Client Opportunities
```typescript
// DetalheCliente.tsx
const { data: opportunities } = useQuery({
  queryKey: ['client-opportunities', clientId],
  queryFn: async () => {
    const { data } = await supabase
      .from('opportunities')
      .select('*, stage:funnel_stages(name, color)')
      .eq('client_id', clientId)
      .order('created_at', { ascending: false })
    return data
  }
})
```

---

## ğŸ¨ Design Tokens

### Avatares Clientes:
```typescript
// Gerar iniciais do nome
const getInitials = (name: string) =>
  name.split(' ').map(n => n[0]).join('').slice(0, 2).toUpperCase()

// Avatar gradient (STAGETEK red)
className="w-12 h-12 bg-gradient-to-br from-[#e90101] to-[#c10101] rounded-full flex items-center justify-center text-white text-sm font-semibold"
```

### Stats Badges:
```typescript
// Badge neutral (mini-stats)
className="px-3 py-1 bg-white/5 border border-white/10 rounded-full text-xs text-gray-300"
```

### Hover ElevaÃ§Ã£o:
```css
.client-card:hover {
  transform: scale(1.02);
  box-shadow: 0 20px 60px rgba(233, 1, 1, 0.3);
}
```

---

## ğŸ“¦ Componentes Criados/Modificados

### Novos Componentes:

1. **`src/hooks/useClientStats.ts`** (30 linhas)
   - Hook para estatÃ­sticas do cliente
   - React Query + Supabase

2. **`src/pages/DetalheCliente.tsx`** (100 linhas, template)
   - PÃ¡gina detalhe completa
   - Layout 3 colunas
   - Breadcrumb + Voltar

3. **`src/components/organisms/ClientOpportunities.tsx`** (50 linhas)
   - Lista oportunidades do cliente
   - Empty state

4. **`src/components/organisms/ClientStats.tsx`** (50 linhas)
   - Card mÃ©tricas (4 stats)
   - Ãcones + formataÃ§Ã£o

5. **`src/components/organisms/ClientActions.tsx`** (50 linhas)
   - BotÃµes quick actions
   - Nova Opp, Email, Mapa, Website

6. **`src/components/molecules/ClientCardRich.tsx`** (60 linhas)
   - Card expandido para grid view
   - Avatar + stats + hover

### Componentes Modificados:

7. **`src/components/molecules/ClientCard.tsx`** (50 linhas)
   - Adicionar localizaÃ§Ã£o, website, stats
   - Manter â‰¤50 linhas

8. **`src/pages/Clientes.tsx`** (150 linhas)
   - Toggle view (table/grid)
   - Conditional render
   - localStorage state

---

## ğŸ§ª Testing Checklist

### Fase 1: ClientCard Enriquecido
- [ ] Stats carregam corretamente (count + sum)
- [ ] Cliente sem endereÃ§o â†’ "Sem localizaÃ§Ã£o"
- [ ] Cliente sem website â†’ nÃ£o mostra seÃ§Ã£o
- [ ] Cliente sem oportunidades â†’ "0 oportunidades"
- [ ] Mobile: layout nÃ£o quebra (<375px)

### Fase 2: DetalheCliente
- [ ] Rota `/clientes/:id` funciona
- [ ] Not found: Cliente inexistente
- [ ] Oportunidades listadas corretamente
- [ ] Stats calculadas: count, sum, avg, %
- [ ] BotÃ£o "Nova Oportunidade" abre modal prÃ©-preenchido
- [ ] BotÃ£o "Ver no Mapa" abre Google Maps
- [ ] BotÃ£o "Email" abre compositor
- [ ] Mobile: tabs grid 2x2 visÃ­veis

### Fase 3: Grid View Desktop
- [ ] Toggle view salva em localStorage
- [ ] Grid 3 colunas (desktop), 2 (tablet), 1 (mobile)
- [ ] Hover: botÃµes aparecem (smooth)
- [ ] Click card â†’ navega para detalhe
- [ ] Skeleton loading (6 placeholders)
- [ ] Performance: grid com 50+ clientes

---

## ğŸ“… Timeline

**Total**: 2 dias (16 horas)

### Day 1 (8h):
- **Morning (4h)**: Fase 1 - ClientCard Enriquecido
  - Hook useClientStats (1h)
  - Atualizar ClientCard (2h)
  - Testes + polish (1h)

- **Afternoon (4h)**: Fase 2 - InÃ­cio DetalheCliente
  - Criar pÃ¡gina + rota (2h)
  - ClientOpportunities component (2h)

### Day 2 (8h):
- **Morning (4h)**: Fase 2 - Finalizar DetalheCliente
  - ClientStats component (2h)
  - ClientActions component (2h)

- **Afternoon (4h)**: Fase 3 - Grid View Desktop
  - Toggle view + localStorage (1h)
  - ClientCardRich component (2h)
  - Testes + polish (1h)

---

## âš ï¸ Riscos & MitigaÃ§Ãµes

### Risco 1: Performance com muitos clientes (>100)
**Prob**: 40% | **Impacto**: MÃ©dio
**MitigaÃ§Ã£o**:
- PaginaÃ§Ã£o: 20 clientes por pÃ¡gina
- Virtual scroll se >100 registros
- Query stats otimizada (index client_id)

### Risco 2: Grid view complexo demais
**Prob**: 30% | **Impacto**: Baixo
**MitigaÃ§Ã£o**:
- Manter toggle table/grid (fallback)
- Grid opcional, tabela padrÃ£o se usuÃ¡rio preferir
- localStorage preserva preferÃªncia

### Risco 3: Stats query lenta
**Prob**: 50% | **Impacto**: MÃ©dio
**MitigaÃ§Ã£o**:
- Cache React Query (staleTime: 5min)
- Mostrar stats incrementalmente (skeleton)
- Calcular stats no backend (materialized view futuro)

---

## ğŸ¯ Definition of Done

- [ ] **Fase 1**: ClientCard mobile mostra localizaÃ§Ã£o + website + stats
- [ ] **Fase 2**: PÃ¡gina `/clientes/:id` funcional (3 colunas + 4 tabs)
- [ ] **Fase 3**: Grid view desktop implementado (toggle table/grid)
- [ ] Protocol Notecraftâ„¢ compliant (componentes â‰¤75 linhas)
- [ ] TypeScript: Zero errors
- [ ] Mobile responsive: 375px, 768px, 1024px testados
- [ ] Performance: Grid com 50 clientes <2s load
- [ ] Testes manuais: 10 cenÃ¡rios (checklist acima)
- [ ] CHANGELOG atualizado

---

## ğŸ“Š MÃ©tricas de Sucesso

| MÃ©trica | Antes | Depois (Meta) |
|---------|-------|---------------|
| Dados visÃ­veis (ClientCard) | 4 campos | 8+ campos âœ… |
| Tempo para ver oportunidades do cliente | 3 clicks | 1 click âœ… |
| Stats disponÃ­veis | 0 | 4 mÃ©tricas âœ… |
| PÃ¡gina detalhe | âŒ NÃ£o existe | âœ… Completa |
| View modes | 1 (tabela) | 2 (tabela + grid) âœ… |

---

## ğŸ”— ReferÃªncias

- **Design Similar**: RD Station CRM - PÃ¡gina Empresas
- **Layout Base**: `DetalheOportunidade.tsx` (3 colunas + tabs)
- **Grid Inspiration**: Notion, Airtable, Monday.com

---

**Criado por**: Sally (UX Expert)
**Data**: 9 Janeiro 2026
**Status**: âœ… Ready for Development
**Sprint Recomendado**: Sprint 2 (Post-MVP)
