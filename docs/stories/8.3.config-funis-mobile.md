# Story 8.3: Config Funis Mobile

**Epic**: EPIC-008 UX Mobile | **Status**: Draft | **Prioridade**: P2 | **Estimativa**: 30 min

## Story
Como administrador mobile, quero editar e excluir etapas de funis em dispositivos móveis sem depender de hover.

## AC
1. **Botões de Edição Sempre Visíveis em Mobile:**
   - Desktop: Aparecem no hover (atual)
   - Mobile: Sempre visíveis
   - Touch targets adequados (44x44px)

2. **Pipeline Vertical com Ações:**
   - Já implementado (linhas 242-283)
   - Adicionar botões Edit/Delete em cada etapa mobile

3. **Alternativa: Context Menu (Long-Press):**
   - Long-press na etapa abre menu de ações
   - Mais limpo visualmente
   - Padrão iOS/Android familiar

## Tasks
- [ ] Remover `md:opacity-0` dos botões de edição
- [ ] OU implementar ContextMenu com long-press
- [ ] Adicionar botões Edit/Delete no layout vertical mobile
- [ ] Testar usabilidade (botões visíveis vs context menu)

## Dev Notes
**Arquivos afetados:**
- `src/pages/ConfigFunis.tsx:183-204` - Botões hover desktop
- `src/pages/ConfigFunis.tsx:276-280` - Layout vertical mobile

**Problema Atual:**
```tsx
{/* Botões aparecem apenas no hover desktop */}
<button className="opacity-0 group-hover/stage:opacity-100 ...">
  <Edit />
</button>
```

Em mobile, não existe hover → botões ficam invisíveis.

**Solução 1: Botões Sempre Visíveis em Mobile**
```tsx
<button className="md:opacity-0 md:group-hover/stage:opacity-100 ...">
  <Edit className="w-5 h-5" />  {/* Aumentado para touch */}
</button>
```

**Solução 2: Context Menu (Mais Limpo)**
```tsx
<ContextMenu>
  <ContextMenuTrigger>
    {/* Stage card */}
    <div className="...">
      {/* Conteúdo da etapa */}
    </div>
  </ContextMenuTrigger>
  <ContextMenuContent>
    <ContextMenuItem onClick={() => handleEditStage(stage)}>
      <Edit className="w-4 h-4 mr-2" />
      Editar Etapa
    </ContextMenuItem>
    <ContextMenuItem
      onClick={() => handleDeleteStage(stage.id, stage.name)}
      className="text-red-400"
    >
      <Trash2 className="w-4 h-4 mr-2" />
      Excluir Etapa
    </ContextMenuItem>
  </ContextMenuContent>
</ContextMenu>
```

**Layout Vertical Mobile (Adicionar Botões):**
```tsx
{/* Mobile: Pipeline vertical - ANTES (linhas 242-283) */}
<div className="flex flex-col gap-4 lg:hidden">
  {funnel.stages.map((stage, index) => (
    <div key={stage.id} className="flex items-start gap-4">
      {/* Bolinha + Conector */}
      <div>...</div>

      {/* Info */}
      <div className="flex-1 pt-2">
        <h3>{stage.name}</h3>
        <p>Etapa {stage.order_position}</p>
      </div>

      {/* ❌ FALTAM BOTÕES AQUI */}
    </div>
  ))}
</div>

{/* Mobile: Pipeline vertical - DEPOIS */}
<div className="flex flex-col gap-4 lg:hidden">
  {funnel.stages.map((stage, index) => (
    <div key={stage.id} className="flex items-start gap-4">
      {/* Bolinha + Conector */}
      <div>...</div>

      {/* Info */}
      <div className="flex-1 pt-2">
        {editingStageId === stage.id ? (
          {/* Input inline edit */}
        ) : (
          <>
            <h3>{stage.name}</h3>
            <p>Etapa {stage.order_position}</p>
          </>
        )}
      </div>

      {/* ✅ BOTÕES ADICIONADOS */}
      <div className="flex items-center gap-2 pt-2">
        <button
          onClick={() => {
            setEditingStageId(stage.id)
            setEditingStageName(stage.name)
          }}
          className="p-3 text-gray-400 hover:text-white hover:bg-white/10 rounded-lg"
          aria-label="Editar etapa"
        >
          <Edit className="w-5 h-5" />
        </button>
        <button
          onClick={() => handleDeleteStage(stage.id, stage.name)}
          className="p-3 text-gray-400 hover:text-[#e90101] hover:bg-[#e90101]/10 rounded-lg"
          aria-label="Excluir etapa"
        >
          <Trash2 className="w-5 h-5" />
        </button>
      </div>
    </div>
  ))}
</div>
```

**Decisão de Design:**
- **Opção A (Simples):** Botões sempre visíveis em mobile - 5 minutos
- **Opção B (Premium):** Context Menu long-press - 30 minutos + criar component

**Recomendação:** Começar com Opção A (quick win), depois avaliar Opção B se houver demanda.

**Componentes (se Opção B):**
- `ContextMenu` (shadcn/ui) ou
- `LongPressMenu` molecule custom (<50 linhas)

**Protocol Notecraft:**
- ConfigFunis.tsx: 341 linhas (organism, dentro do limite)
- Mudanças incrementais, sem refatoração grande

**Testes:**
- Testar usabilidade: botões visíveis vs context menu
- Touch targets adequados (mínimo 44x44px)
- Feedback visual ao pressionar
